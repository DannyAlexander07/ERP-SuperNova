<div class="pos-container">
    
    <div class="pos-catalog">
        <div class="catalog-header">
            <div class="catalog-title-bar">
                <div>
                    <h2>Ventas en caja</h2>
                    <p>Selecciona productos y finaliza el cobro en segundos.</p>
                </div>
                <div class="catalog-meta">
                    <span class="meta-pill">
                        <i class='bx bx-store-alt'></i> M贸dulo POS
                    </span>
                    <span class="meta-pill status-pill">
                        <span class="status-dot"></span> Caja abierta
                    </span>
                </div>
            </div>

            <div class="search-bar">
                <i class='bx bx-search'></i>
                <input 
                    type="text" 
                    id="pos-search" 
                    placeholder="Buscar producto (Nombre o C贸digo)..." 
                    onkeyup="filtrarProductosPOS()"
                >
            </div>

            <div class="category-tabs">
                <button class="cat-btn active" onclick="filtrarCategoriaPOS('todos', this)">Todo</button>
                <button class="cat-btn" onclick="filtrarCategoriaPOS('Cafeteria', this)">Cafeter铆a</button>
                <button class="cat-btn" onclick="filtrarCategoriaPOS('Taquilla', this)">Taquilla</button>
                <button class="cat-btn" onclick="filtrarCategoriaPOS('Merch', this)">Merch</button>
                <button class="cat-btn" onclick="filtrarCategoriaPOS('Arcade', this)">Arcade</button>
            </div>
        </div>

        <div class="products-grid" id="pos-products-container"></div>
    </div>

    <div class="pos-ticket" id="ticket-panel">
        <div class="ticket-header">
            <div class="ticket-title">
                <div class="ticket-icon">
                    <i class='bx bx-receipt'></i>
                </div>
                <div>
                    <h3>Orden de venta</h3>
                    <span class="ticket-subtitle">Caja 01 路 POS SuperNova</span>
                </div>
            </div>
            <i class='bx bx-x close-ticket-mobile' onclick="toggleCarritoMovil()"></i>
        </div>

        <div class="ticket-items" id="pos-cart-items"></div>

        <div class="ticket-footer">
            <div class="ticket-summary">
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="lbl-subtotal">S/ 0.00</span>
                </div>
                <div class="summary-row">
                    <span>IGV (18%)</span>
                    <span id="lbl-igv">S/ 0.00</span>
                </div>
                <div class="summary-row total">
                    <span>Total</span>
                    <span id="lbl-total">S/ 0.00</span>
                </div>
            </div>
            <button class="btn-checkout" onclick="abrirModalCobro()">
                COBRAR <i class='bx bx-right-arrow-alt'></i>
            </button>
        </div>
    </div>

    <div class="float-cart-btn" onclick="toggleCarritoMovil()">
        <i class='bx bx-cart'></i>
        <span id="float-total">S/ 0.00</span> 
    </div>
</div> 
<div id="modal-cobro" class="modal-overlay">
    <div class="modal-content center-modal" style="max-width: 500px;"> 
        <div class="modal-header">
            <h3>Finalizar venta</h3>
            <button class="btn-close" onclick="cerrarModalCobro()">
                <i class='bx bx-x'></i>
            </button>
        </div>
        
        <div class="modal-body">
            <h2 class="total-amount-display" id="modal-total-display" style="font-size: 32px; color: #6366f1; margin-bottom: 20px;">S/ 0.00</h2>

            <div class="assignment-section" style="background: #f8fafc; padding: 15px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #e2e8f0;">
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <div>
                        <label style="font-size: 11px; font-weight: 700; color: #64748b; display:block; margin-bottom:4px;">VENDEDOR</label>
                        <select id="modal-vendedor" style="width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px;">
                            <option value="" selected>Caja General</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-size: 11px; font-weight: 700; color: #64748b; display:block; margin-bottom:4px;">TIPO PRECIO</label>
                        <select id="modal-tipo-venta" style="width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px;">
                            <option value="Unitaria">Normal</option>
                            <option value="Mayorista">Mayorista</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label style="font-size: 11px; font-weight: 700; color: #64748b; display:block; margin-bottom:4px;">DESCUENTO / CONVENIO</label>
                    <select id="modal-convenio" onchange="aplicarDescuentoConvenio()" style="width: 100%; padding: 8px; border: 1px solid #818cf8; border-radius: 6px; background: #e0e7ff; color: #312e81; font-weight: 600;">
                        <option value="0" selected>Ninguno (Precio Full)</option>
                        <option value="0.50">Convenio: Empleados (50%)</option>
                        <option value="0.20">Convenio: Socios (20%)</option>
                        <option value="0.10">Promo: Cumplea帽os (10%)</option>
                        <option value="1.00">Cortes铆a Total (100%)</option>
                    </select>
                </div>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="font-size: 12px; font-weight: 700; color: #333; margin-bottom: 8px; display: block;">TIPO DE COMPROBANTE</label>
                <div style="display: flex; gap: 10px;">
                    <label style="flex: 1; cursor: pointer;">
                        <input type="radio" name="tipo_comprobante" value="Boleta" checked onchange="toggleCamposFactura()" style="display:none;">
                        <div class="comprobante-btn" id="btn-boleta" style="text-align:center; padding: 10px; border: 2px solid #6366f1; background: #e0e7ff; color: #6366f1; border-radius: 8px; font-weight:bold;">
                             BOLETA
                        </div>
                    </label>
                    <label style="flex: 1; cursor: pointer;">
                        <input type="radio" name="tipo_comprobante" value="Factura" onchange="toggleCamposFactura()" style="display:none;">
                        <div class="comprobante-btn" id="btn-factura" style="text-align:center; padding: 10px; border: 1px solid #ccc; background: #fff; color: #666; border-radius: 8px; font-weight:bold;">
                             FACTURA
                        </div>
                    </label>
                </div>
            </div>

            <div id="container-datos-cliente" style="margin-bottom: 20px;">
                
                <div id="campo-dni">
                    <div class="input-group" style="display: flex; gap: 5px; align-items: center; margin-bottom: 8px;">
                        <div style="flex-grow: 1; position: relative;">
                            <input type="text" id="cliente-dni" placeholder=" " maxlength="11" style="width: 100%;" 
                                onkeyup="detectarCambioDocumento(this.value)"> 
                            <label>DNI / Cliente Gen茅rico</label>
                        </div>
                        <button type="button" onclick="consultarIdentidadPOS('dni')" class="btn-search-identidad" 
                                title="Consultar RENIEC" style="padding: 10px; background: #6366f1; color: white; border: none; border-radius: 8px; cursor: pointer;">
                            <i class='bx bx-search-alt'></i>
                        </button>
                    </div>
                    <div class="input-group">
                        <input type="text" id="cliente-nombre-natural" placeholder=" " readonly style="background-color: #f8fafc;">
                        <label>Nombre del Cliente</label>
                    </div>
                </div>
                <div id="campos-factura" style="display: none; background: #fff1f2; padding: 15px; border-radius: 12px; border: 1px dashed #f43f5e; margin-top: 10px;">
                    <div class="input-group" style="display: flex; gap: 5px; align-items: center; margin-bottom: 12px;">
                        <div style="flex-grow: 1; position: relative;">
                            <input type="text" id="cliente-ruc" placeholder=" " maxlength="11" style="width: 100%;">
                            <label style="color: #be123c;">RUC (Obligatorio)*</label>
                        </div>
                        <button type="button" onclick="consultarIdentidadPOS('ruc')" class="btn-search-identidad" 
                                title="Consultar SUNAT" style="padding: 10px; background: #be123c; color: white; border: none; border-radius: 8px; cursor: pointer;">
                            <i class='bx bx-search-alt'></i>
                        </button>
                    </div>
                    
                    <div class="input-group" style="margin-bottom: 12px;">
                        <input type="text" id="cliente-razon" placeholder=" " style="border: 1px solid #fda4af;" readonly>
                        <label style="color:#be123c">Raz贸n Social</label>
                    </div>
                    <div class="input-group">
                        <input type="text" id="cliente-direccion" placeholder=" ">
                        <label>Direcci贸n Fiscal</label>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="font-size: 12px; font-weight: 700; color: #333; margin-bottom: 8px; display: block;">MTODO DE PAGO</label>
                <div class="payment-methods-grid" style="grid-template-columns: repeat(4, 1fr); gap: 8px;">
                    <label class="method-card">
                        <input type="radio" name="pago" value="Efectivo" checked onchange="toggleOpcionesTarjeta()">
                        <div class="card-content" style="padding: 10px 5px; font-size: 11px;">
                            <i class='bx bx-money' style="font-size: 20px; margin-bottom: 4px;"></i><br>Efectivo
                        </div>
                    </label>
                    <label class="method-card">
                        <input type="radio" name="pago" value="Yape" onchange="toggleOpcionesTarjeta()">
                        <div class="card-content" style="padding: 10px 5px; font-size: 11px;">
                            <i class='bx bx-qr' style="font-size: 20px; margin-bottom: 4px; color:#a08fff;"></i><br>Yape
                        </div>
                    </label>
                    <label class="method-card">
                        <input type="radio" name="pago" value="Plin" onchange="toggleOpcionesTarjeta()">
                        <div class="card-content" style="padding: 10px 5px; font-size: 11px;">
                            <i class='bx bx-mobile-alt' style="font-size: 20px; margin-bottom: 4px; color:#3fc8f4;"></i><br>Plin
                        </div>
                    </label>
                    <label class="method-card">
                        <input type="radio" name="pago" value="Tarjeta" onchange="toggleOpcionesTarjeta()">
                        <div class="card-content" style="padding: 10px 5px; font-size: 11px;">
                            <i class='bx bx-credit-card' style="font-size: 20px; margin-bottom: 4px;"></i><br>Tarjeta
                        </div>
                    </label>
                </div>

                <div id="opciones-tarjeta" style="display: none; margin-top: 10px; background: #f0fdf4; padding: 10px; border-radius: 8px; border: 1px solid #bbf7d0;">
                    <label style="font-size: 11px; font-weight: bold; color: #166534; display:block; margin-bottom: 5px;">TIPO DE TARJETA:</label>
                    <div style="display: flex; gap: 10px;">
                        <label style="flex: 1; display: flex; align-items: center; gap: 5px; font-size: 13px; cursor: pointer;">
                            <input type="radio" name="tipo_tarjeta" value="Debito" checked>  D茅bito
                        </label>
                        <label style="flex: 1; display: flex; align-items: center; gap: 5px; font-size: 13px; cursor: pointer;">
                            <input type="radio" name="tipo_tarjeta" value="Credito">  Cr茅dito
                        </label>
                    </div>
                </div>
            </div>

        </div>

        <div style="margin-bottom: 10px;">
            <label style="font-size: 11px; font-weight: 800; color: #475569; text-transform: uppercase; margin: 18px 18px 0; display: block;">
                Tama帽o de Impresi贸n
            </label>
            <div class="print-format-grid">
                <label class="format-card">
                    <input type="radio" name="formato_impresion" value="3" checked>
                    <div class="format-content">
                        <i class='bx bx-receipt'></i>
                        <span>TICKET</span>
                    </div>
                </label>
                
                <label class="format-card">
                    <input type="radio" name="formato_impresion" value="1">
                    <div class="format-content">
                        <i class='bx bx-file'></i>
                        <span>A4</span>
                    </div>
                </label>
                
                <label class="format-card">
                    <input type="radio" name="formato_impresion" value="2">
                    <div class="format-content">
                        <i class='bx bx-copy-alt'></i>
                        <span>A5</span>
                    </div>
                </label>
            </div>
        </div>
        
        <div class="modal-footer">
            <button 
                class="btn-primary full-width" 
                style="height: 50px; font-size: 18px; justify-content: center;" 
                onclick="procesarVenta()"
            >
                Confirmar e Imprimir
            </button>
        </div>
    </div>
</div>